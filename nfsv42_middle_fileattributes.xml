<!-- Copyright (C) The IETF Trust (2011-2012) -->
<!-- Copyright (C) The Internet Society (2011-2012) -->

<section anchor="sec:file_attributes" title="New File Attributes">
  <section anchor="ss:file_attributes:REC" title="New RECOMMENDED Attributes - List and Definition References">
    <t>
      The list of new RECOMMENDED attributes appears in <xref target="tbl:rec_attr" />.  The meaning of
      the columns of the table are:
    </t>

    <t>
      <list style='hanging'>
        <t hangText='Name:'>
          The name of the attribute.
        </t>

        <t hangText='Id:'>
          The number assigned to the attribute.  In the event of
          conflicts between the assigned number and <xref target="ref:4.2xdr" />, the latter is
          likely authoritative, but should be resolved with Errata to this
          document and/or <xref target="ref:4.2xdr" />.  See <xref target="IESG08" /> for the Errata process.
        </t>

        <t hangText='Data Type:'>
          The XDR data type of the attribute.
        </t>

        <t hangText='Acc:'>
          Access allowed to the attribute.
          <list style='hanging'>
            <t hangText='R'>
              means read-only (GETATTR may retrieve, SETATTR may not set).
            </t>
            <t hangText='W '>
             means write-only (SETATTR may set, GETATTR may not retrieve).
            </t>
            <t hangText='R W '>
             means read/write (GETATTR may retrieve, SETATTR may set).
            </t>
          </list>
        </t>

        <t hangText='Defined in:'>
          The section of this specification that describes the
          attribute.
        </t>
      </list>
    </t>

    <texttable anchor="tbl:rec_attr">
      <ttcol align="left">Name</ttcol>
      <ttcol align="left">Id</ttcol>
      <ttcol align="left">Data Type</ttcol>
      <ttcol align="left">Acc</ttcol>
      <ttcol align="left">Defined in</ttcol>
      <c>change_attr_type</c> <c>79</c> <c>change_attr_type4</c>  <c>R  </c> <c><xref target="ss:chattr:defn" /></c>
      <c>sec_label</c>        <c>80</c> <c>sec_label4</c>         <c>R W</c> <c><xref target="ss:macss:lnfs:interpret" /></c>
      <c>space_reserved</c>   <c>77</c> <c>boolean</c>            <c>R W</c> <c><xref target="ss:space:ops:sr" /></c>
      <c>space_freed</c>      <c>78</c> <c>length4</c>            <c>R  </c> <c><xref target="ss:space:ops:sf" /></c>
    </texttable>
  </section>

  <section anchor="ss:file_attributes:AD" title="Attribute Definitions">
    <section toc='exclude' anchor="ss:space:ops:sr" title="Attribute 77: space_reserved">
      <t>
        The space_reserve attribute is a read/write attribute of type
        boolean.  It is a per file attribute.  When the space_reserved
        attribute is set via SETATTR, the server must ensure that there is
        disk space to accommodate every byte in the file before it can return
        success.  If the server cannot guarantee this, it must return
        NFS4ERR_NOSPC.
      </t>

      <t>
        If the client tries to grow a file which has the space_reserved
        attribute set, the server must guarantee that there is disk space to
        accommodate every byte in the file with the new size before it can
        return success.  If the server cannot guarantee this, it must return
        NFS4ERR_NOSPC.
      </t>

      <t>
        It is not required that the server allocate the space to the file
        before returning success.  The allocation can be deferred, however,
        it must be guaranteed that it will not fail for lack of space.
      </t>

      <t>
        The value of space_reserved can be obtained at any time through
        GETATTR.
      </t>

      <t>
        In order to avoid ambiguity, the space_reserve bit cannot be set
        along with the size bit in SETATTR.  Increasing the size of a file
        with space_reserve set will fail if space reservation cannot be
        guaranteed for the new size.  If the file size is decreased, space
        reservation is only guaranteed for the new size and the extra blocks
        backing the file can be released.
      </t>
    </section>

    <section toc='exclude' anchor="ss:space:ops:sf" title="Attribute 78: space_freed">
      <t>
        space_freed gives the number of bytes freed if the file is deleted.
        This attribute is read only and is of type length4.  It is a per file
        attribute.
      </t>
    </section>
  </section>
</section>
